<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:html="http://www.w3.org/TR/REC-html40">
  <Worksheet ss:Name="Sheet1">
    <Table>
      <Row>

      <Cell ss:Index="1"><Data ss:Type="String">No</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Code</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Name</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Month</Data></Cell>
      
      <Cell ss:Index="1"><Data ss:Type="String">Basic</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">DA</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">HRA</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">conv</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">O.Allow</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">S.Allow</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Wsh.Allow</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Driver Allow</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Medi Allow</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Child Edu Allow</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">MRA</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Gross</Data></Cell>

      <Cell ss:Index="1"><Data ss:Type="String">PF</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">ESIC</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">IT</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">PT</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Adv.Sal</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Society</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Food</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Mobile</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Retention</Data></Cell>
      <Cell ss:Index="1"><Data ss:Type="String">Total Dedu</Data></Cell>

      <Cell ss:Index="1"><Data ss:Type="String">NET</Data></Cell>
    </Row>

    <% i = 0 %>
    <% @reports.each do |r| %>
       <Row>
        <Cell ss:Index="1"><Data ss:Type="String"><%= i = i+1 %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="String"><%= r.try(:code) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="String"><%= r.try(:employee_name) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="String"><%= r.try(:month) %></Data></Cell>
        
        
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_basic).try(:round) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_da).try(:round) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_hra).try(:round) %></Data></Cell>

        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_convenience).try(:round) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_other).try(:round) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_special).try(:round) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_washing).try(:round) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_driver).try(:round) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_medical).try(:round) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_child_edu).try(:round) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_mra).try(:round) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:earned_total).try(:round) %></Data></Cell>

        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:pf) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:esic) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:income_tax) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:pt) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:advance) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:society) %></Data></Cell>

        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:food_deduction) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:mobile) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:retention) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:deduction_total) %></Data></Cell>
        <Cell ss:Index="1"><Data ss:Type="Number"><%= r.try(:net_payable) %></Data></Cell>
     </Row>
    <% end %>  
    </Table>
  </Worksheet>
</Workbook>
