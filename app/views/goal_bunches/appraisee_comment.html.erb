<div class="box box-default">
  <div class="box-header with-border">
    <h3 class="box-title">Employee Details</h3>
  </div><!-- /.box-header -->
  <div class="box-body">
<table class="table table-bordered table-hover table-condensed">     
  <thead>
    <tr>
      <th>Employee Id</th>
      <th>Name</th>
      <th>Age</th>
      <th>Department</th>
      <th>Date Of Joining</th>
      <th>Grade</th>
      <th>Current Designation</th> 
    </tr>
  </thead>
  <tbody>
    <% @employees.each do |a| %>
    <tr>
      <td><%= a.manual_employee_code %></td> 
      <td><%= a.first_name %></td>
      <td><%=  %></td>
      <td><%= a.department.try(:name) %></td>
      <td><%= @joining_detail.joining_date %></td>
      <td><%= @joining_detail.employee_grade.name %></td>
      <td><%= @joining_detail.employee_designation.name %></td>
    </tr>
    <% end %>
  </tbody>
</table>

<div class="box-header with-border">
  <h3 class="box-title">Qualification Details</h3>
</div>
<table class="table table-bordered table-hover table-condensed">
  <thead>
    <tr>
      <th>Degree</th>
      <th>Year Of Passing</th>
      <th>Marks</th>
      <th>Qualification</th>
    </tr>
  </thead>
  <tbody>
    <% @qualifications.each do |q| %>
      <tr>
        <td><%= q.degree.name %></td>
        <td><%= q.year.name%> </td>
        <td><%= q.marks %></td>
        <td><%= q.degree_type.name %></td>
      </tr>
    <% end %>
  </tbody>
</table>


<div class="box box-default">
  <div class="box-header with-border">
    <h3 class="box-title">Goal Rating</h3>
  </div><!-- /.box-header -->
  <div class="box-body">
  <%= bootstrap_form_for (@goal_rating),url:{action:'self_comment',emp_id: @employee.id,goal_bunch_id: @goal_bunch_id.id} do |f| %>  
    <table class="table table-bordered table-hover table-condensed">
      <thead>
        <tr>
          <th>Goal Perspective</th>
          <th>Goal Weightage</th>
          <th>Goal Measure</th>
          <th>Target/Unit</th>
          <th>Aligned</th>
          <th>Self Comment</th>
        </tr>
      </thead>
      <tbody>
        <% @goal_ratings.each do |goal_rating| %>
          <tr>
            <td><%= goal_rating.goal_perspective.name %></td>
            <td><%= goal_rating.goal_weightage %></td>
            <td><%= goal_rating.goal_measure %></td>
            <td><%= goal_rating.target %></td>
            <td><%= goal_rating.aligned %></td>
            <td><%= text_field_tag 'appraisee_comment[]',"",class: "form-control" %></td>
            <%= hidden_field_tag 'goal_rating_ids[]',"",value: goal_rating.id %>
          </tr>
        <% end %>
      </tbody>
    </table>

  <% unless @goal_ratings.empty? %>
  <div class="row">
    <div class="col-sm-3">
      <div class="actions">
        <%= f.submit "Create Comment", class: 'btn btn-primary btn-sm' %> 
      </div>
    </div>
  </div>
  <% end %> 
  <% end %>
</div>
</div>
<div id="myModal" class="modal fade"></div>

<div class="box box-default">
  <div class="box-header with-border">
    <h3 class="box-title">Created Goal Rating</h3>
  </div><!-- /.box-header -->
  <div class="box-body">
  <%= bootstrap_form_for GoalBunch.new,url:{action:'self_comment_confirm'} do |f| %>
    <table class="table table-bordered table-hover table-condensed">
      <thead>
        <tr>
          <th>Goal Perspective</th>
          <th>Goal Weightage</th>
          <th>Goal Measure</th>
          <th>Target/Unit</th>
          <th>Aligned</th>
          <th>Self Comment</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <% @self_goal_ratings.each do |goal_rating| %>
          <tr>
            <td><%= goal_rating.goal_perspective.name %></td>
            <td><%= goal_rating.goal_weightage %></td>
            <td><%= goal_rating.goal_measure %></td>
            <td><%= goal_rating.target %></td>
            <td><%= goal_rating.aligned %></td>
            <td><%= goal_rating.appraisee_comment %></td>
            <td>
            <% if @goal_bunch.appraisee_confirm == true %>
              <small class="label label-info">Confirmed</small>
            <% else %>
              <%= link_to '', self_modal_goal_ratings_path(goal_rating),class: 'btn btn-xs btn-success fa fa-edit',remote: true %>
              
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>

  <div class="row">
    <div class="col-sm-3">
      <div class="actions">
        <% unless @goal_ratings.empty? %>
        <% else %>
          <% unless @goal_bunch.nil? %>
            <% if @goal_bunch.appraisee_confirm == true %>
            <% else %>
            <%= link_to 'Overall Comment', modal_self_overall_goal_bunches_path(goal_bunch_id: @goal_bunch.id),class: 'btn btn-warning btn-sm',remote: true %>
            <% end %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
<% end %>

<div class="box-header with-border">
  <h3 class="box-title">Overall Comment</h3>
</div>
<%= bootstrap_form_for GoalBunch.new,url:{action:'self_overall_comment_confirm',emp_id: @employee.id,goal_bunch_id: @goal_bunch.id} do |f| %>
 <table class="table table-bordered table-hover table-condensed">
    <thead>
      <tr>
        <th><input type="checkbox" id="selectAll" value="selectAll"></th>
        <th>Overall Comment</th>
      </tr>
    </thead>
    <tbody>
    <% @goal_bunches.each do |goal_bunch| %>
      <tr>
        <td>
          <% if goal_bunch.appraisee_confirm == true %>
          <% else %>
          <%= check_box_tag "goal_bunch_ids[]", goal_bunch.id %>
          <% end %>
        </td>
        <td><%= goal_bunch.appraisee_comment %></td>
      </tr>
      <% end %>
    </tbody>
  </table>

    <% unless @goal_bunch.nil? %>
      <% if @goal_bunch.appraisee_comment == nil %>
      <% else %>
        <div class="row">
          <div class="col-sm-3">
            <div class="actions">
              <%= f.submit "Confirm", class: 'btn btn-primary btn-sm' %>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
<% end %>
  <br>
   <%= link_to 'Back',period_list_appraisee_goal_bunches_path(id: @employee.id),class: 'btn btn-sm btn-default'%>
</div>
</div>
<div id="myModal" class="modal fade"></div>
<script type="text/javascript">
  $(function () {
    $('#selectAll').click(function() {
      if (this.checked) {
        $(':checkbox').each(function() {
          this.checked = true;                       
        });
      } 
      else {
        $(':checkbox').each(function() {
          this.checked = false;                        
        });
      } 
    });
  });
</script>
