 def self.fetch_data
    punch = PunchTimeDetail.where("LogDateTime > ? ", Time.now - 33.days)
    punch.each do |mat|
      edate_time = mat.LogDateTime
      edate = edate_time.to_date
      punchtime = mat.LogDateTime
      etime = punchtime.to_time
      user_id = mat.EmpCode
      month_nm = edate.strftime("%B")
      emp =  Employee.find_by_manual_employee_code(user_id)
      empa =  Employee.find_by_manual_employee_code(user_id)
      if empa.nil?
        puts "Employee Id not found"
      else
        emp_id = empa.id
        emp_first = emp.first_name
        emp_last = emp.last_name
        space = " "
        if emp_last.present?
          emp_name = emp_first + space + emp_last
        else
          emp_name = emp_first
        end
        daily_att = DailyAttendance.where(employee_code: user_id, time: etime)
        if daily_att.empty?
          daily_att_updated = DailyAttendance.create(employee_code: user_id, date: edate_time.to_date, time: etime)
          puts "-----DailyAttendance---- created 0 #{Time.now}---------"
        else 
        end
        daily_att = DailyAttendance.where(employee_code: user_id, time: etime).order("time ASC")
        @in_time_data = daily_att.first.time.to_time
        emp_att = EmployeeAttendance.where(employee_id: emp_id, day: edate)
        if emp_att.present?
          time = EmployeeAttendance.where(employee_id: emp_id, in_time: etime)
          if time.present?            
            emp_att_time = emp_att.update_all(in_time: @in_time)
            # emp_att_time = emp_att.update_all(in_time: etime)
          else
            emp_att_out_time = emp_att.update_all(out_time: etime)
            # emp_att_in_time = emp_att.update_all(in_time: @in_time_data)
            puts "-----------EmployeeAttendance updated #{Time.now}-----------"
          end
        else
          emp_att_time = EmployeeAttendance.create(employee_id: emp_id, day: edate, present: "P", in_time: etime, month_name: month_nm, employee_code: user_id, employee_name: emp_name)
          puts "-------EmployeeAttendance created 1 #{Time.now}---------"
        end
      end
    end
  end