<div class="box box-default">
  <div class="box-header with-border">
    <h3 class="box-title">Employee Details</h3>
  </div>
  <div class="box-body">
  	<table class="table table-bordered table-hover table-condensed">     
      <thead>
  	    <tr>
  	    	<th>Employee Id</th>
  	    	<th>Name</th>
          <th>Age</th>
  	    	<th>Department</th>
  	    	<th>Date Of Joining</th>
  	    	<th>Grade</th>
  	    	<th>Current Designation</th> 
        </tr>
      </thead>
      <tbody>
        <% @attribute_rating_sheets.each do |a| %>
        <tr>
          <td><%= a.appraisee.manual_employee_code %></td> 
          <td><%= a.appraisee.first_name %></td>
          <td><%= Time.now.year-a.appraisee.date_of_birth.year %></td>
          <td><%= a.appraisee.department.name %></td>
          <td><%= @joining_detail.joining_date %></td>
          <td><%= @joining_detail.employee_grade.name %></td>
          <td><%= @joining_detail.employee_designation.name %></td>
        </tr>
        <% end %>
      </tbody>
    </table>

    <div class="row">
      <div class="col-sm-6">
        <div class="box-header with-border">
          <h3 class="box-title">Previous Experience</h3>
        </div>
        <table class="table table-bordered table-hover table-condensed">
          <thead>
            <tr>
      	    	<th>Previous Company</th>
              <th>Designation</th>
              <th>Previous Exp.(Years)</th>
              <th>CTC</th>
            </tr>
          </thead>
          <tbody>
            <% @experiences.each do |e| %>
              <tr>
                <td><%= e.company_name %></td>
                <td><%= e.designation %></td>
                <td><%= e.no_of_year %></td>
                <td><%= e.ctc %></td>
              </tr>
            <% end %>
          </tbody>
      	</table>
      </div>

      <div class="col-sm-6">
        <div class="box-header with-border">
          <h3 class="box-title">Qualification Details</h3>
        </div>
        <table class="table table-bordered table-hover table-condensed">
          <thead>
            <tr>
              <th>Degree</th>
              <th>Year Of Passing</th>
              <th>Marks</th>
              <th>Qualification</th>
            </tr>
          </thead>
          <tbody>
            <% @qualifications.each do |q| %>
              <tr>
                <td><%= q.degree.name %></td>
                <td><%= q.year.name%> </td>
                <td><%= q.marks %></td>
                <td><%= q.degree_type.name %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>

    <%= bootstrap_form_for(:goal_rating_sheet,url:{action: "appraiser2_create",id: @employee.id}) do |f| %>
      <%= hidden_field_tag :appraiser_2_id, {},value: current_user.employee_id %>
    	<div class="box-header with-border">
        <h3 class="box-title">Goals Comments and Ratings</h3>
      </div>
  	  <table class="table table-bordered table-hover table-condensed example3">
        <thead>
          <tr>
            <th>Goal Perspective</th>
            <th>Goal Measure</th>
            <th>Target/Unit</th>
            <th>Goal Weightage</th>
            <th>Difficulty Level</th>
            <th>Aligned To Supervisor</th>

            <th>Appraisee Comment</th>
            <th>Appraisee Evaluation</th>
            <th>Appraiser Comment</th>
            <th>Appraiser Evaluation</th>
            <th>Reviewer Comment</th>
            <th>Reviewer Evaluation</th>
          </tr>
        </thead>
        <tbody>
          <% @goal_rating_sheets.each do |g| %>
            <tr>
              <td><%= g.employee_goal.goal_perspective.try(:name) %></td>
              <td><%= g.employee_goal.goal_measure %></td>
              <td><%= g.employee_goal.target %></td>
              <td><%= g.employee_goal.goal_weightage %></td>
              <td><%= g.employee_goal.difficulty_level %></td>
              <td><%= g.employee_goal.allign_to_supervisor %></td>

              <td><%= g.appraisee_comment %></td>
              <td><%= g.appraisee_rating_id %></td>
              <td><%= g.appraiser_comment %></td>
              <td><%= g.appraiser_rating_id %></td>
              <td><%= text_field_tag 'appraiser2_comment[]',"",class: "form-control" %></td>
              <td><%= select_tag 'appraiser2_rating_id[]',options_for_select(all_rating_type) ,{class: 'form-control', hide_label: true,include_blank: " Select Rating"} %></td>
              <%= hidden_field_tag 'goal_rating_sheet_id[]', {},value: g.id %> 
            </tr>
          <% end %>
        </tbody>
      </table>

      <% unless @goal_rating_sheets.empty? %>
        <div class="row">
          <div class="col-sm-3">
            <div class="actions">
              <%= f.submit "Assign Rating" , class: "btn btn-primary btn-sm" %>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>

    <%= bootstrap_form_for :goal_rating_sheet,url:{action:'is_confirm_appraiser2',id: @employee.id} do |f| %>
      <%= hidden_field_tag :appraiser_2_id, {},value: current_user.employee_id %>
      <div class="box-header with-border">
        <h3 class="box-title">Goal Confirmation</h3>
      </div>
      <table class="table table-bordered table-hover table-condensed example3">
        <thead>
          <tr>
            <th><input type="checkbox" id="selectAll" value="selectAll"></th>
            <th>Goal Perspective</th>
            <th>Goal Measure</th>
            <th>Target/Unit</th>
            <th>Goal Weightage</th>
            <th>Difficulty Level</th>
            
            <th>Aligned To Supervisor</th>
            <th>Appraisee Comment</th>
            <th>Appraisee Evaluation</th>
            <th>Appraiser Comment</th>
            <th>Appraiser Evaluation</th>
            <th>Reviewer Comment</th>
            <th>Reviewer Evaluation</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <% @goal_rating_shets.each do |g| %>
            <tr>
              <td><%= check_box_tag "goal_rating_sheet_ids[]", g.id unless g.is_confirm_appraiser2 %></td>
              <td><%= g.employee_goal.goal_perspective.try(:name) %></td>
              <td><%= g.employee_goal.goal_measure %></td>
              <td><%= g.employee_goal.target %></td>
              <td><%= g.employee_goal.goal_weightage %></td>
              <td><%= g.employee_goal.difficulty_level %></td>
              <td><%= g.employee_goal.allign_to_supervisor %></td>

              <td><%= g.appraisee_comment %></td>
              <td><%= g.appraisee_rating.try(:code) %></td>
              <td><%= g.appraiser_comment %></td>
              <td><%= g.appraiser_rating.try(:code)%></td>
              <td><%= g.appraiser2_comment %></td>
              <td><%= g.appraiser2_rating.try(:code) %></td>
              <td>
                <% if g.is_confirm_appraiser2 %>
                  <small class="label label-info">Confirmed</small>
                <% else %>
                  <%= link_to '', modal_appraiser2_goal_rating_sheets_path(g) ,class: 'btn btn-xs btn-success fa fa-edit', remote: true %>
                <% end %>
              </td>
              <%= hidden_field_tag 'goal_rating_sheet_id[]', {},value: g.id %> 
            </tr>
          <% end %>
        </tbody>
      </table>
      <div class="row">
        <div class="col-sm-3">
          <div class="actions">
            <%= f.submit "Confirm", class: 'btn btn-primary btn-sm' %>
            <%= link_to 'Attribute', appraiser2_attribute_rating_sheets_path(@employee.id) ,class: 'btn btn-warning btn-sm' %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
        
<div id="myModal" class="modal fade"></div></br>
      
<%= link_to 'Back', subordinate_list2_goal_rating_sheets_path(@employee.id),class: 'btn btn-default btn-sm fa fa-arrow-left' %>

<script type="text/javascript">
  $(function () {
    $('#selectAll').click(function() {
      if (this.checked) {
        $(':checkbox').each(function() {
          this.checked = true;                       
        });
      } 
      else {
        $(':checkbox').each(function() {
          this.checked = false;                        
        });
      } 
    });
  });

  $(document).ready(function(){
    $('.example3').DataTable({
      "scrollX":        "1200px",
      "paging":         false,
      "searching":      false
    });
  });
</script>